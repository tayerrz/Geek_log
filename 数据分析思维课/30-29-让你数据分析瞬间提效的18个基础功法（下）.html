<p>数据给你一双看透本质的眼睛，这里是《数据分析思维课》，我是郭炜。</p><p>上节课我给你讲了做Excel的初级技巧，你在日常使用中绝大部分都会用到。而如果你想要成为Excel高手，还要掌握下面的7种技巧。</p><p>从第12个技巧开始，这些就会是稍微复杂的Excel的公式使用方法了，这些方法可以帮助你在不使用数据库和编程序方法的情况下，使用Excel来处理非常复杂的一些计算逻辑，帮助你解决日常当中遇到的一些复杂问题。</p><p>不要担心，这些并不是Excel里最复杂的“宏编程”，不需要你掌握复杂的编程知识，我用的都是比较简单的例子和方式，让你一看就会一学就懂，通过学习很少量的技巧，助你快速成为一个Excel专家。</p><h3>12.条件分支计算</h3><p>我们在日常工作当中经常会遇到某一些数据在某种情况下我们按照这种方法计算，在其他条件下又按另一种方法计算。比如对于计算销售提成来说，大多数公司都是在某一个价格范围里是按照一个销售提成计算，在另一个价格范围里，按照别的销售提成计算。这个时候怎么在Excel里面去处理呢？这就用到了Excel的条件分支计算。使用起来很简单，把逻辑直接写在Excel单元格的公式里就可以。</p><p>有时你在进行Excel计算的时候，还会遇到一些数据出现错误表示#ERROR、或者是出现空值#NA的情况，这时候再进行求和、求平均值等复杂公式计算的时候，你经常会因为这一个数字把一群数字的值都无法计算出来，这样就非常的讨厌。我告诉你，你也可以通过条件分支的情况把这个问题解决掉，具体解决的方法我给你演示下。</p><!-- [[[read_end]]] --><p><video poster="https://media001.geekbang.org/47c052469dfa4c33991a99f45bfa61d6/snapshots/8275ecf2a10149c1839546d16f9bb325-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/ff9492-17c7256c746-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/16b42f757fbb4176b00edb5a6dd99270/2697ce8ea744492da2393c2a75384c65-57378820f8d2f1ed960bc93925be5804-sd.m3u8" type="application/x-mpegURL"></video></p><h3>13.统计个数</h3><p>我们经常会统计某一个时间段里的数量是多少，比如我们进行正态分布曲线统计的时候，你就要分片分段来统计不同分段里面的数据分布情况，又或者你去统计某一个班里面不同分数学生的整体情况，也要计算不同分数段不同学生的占比。这个时候我们就会使用统计个数的函数FREQUENCY，使用方法可以参考我给你演示的视频。</p><p><video poster="https://media001.geekbang.org/02f8c8a964aa4e7a90da193f4432818e/snapshots/0a3e9e0a9d5c45b28fa1a43993c9af36-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/58e8e588-17c7256c227-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/173570cdb30f4101b6be80adc97684ac/6ec10af6c55144b7b0ca0e7c847ceed1-682ca470476d0dac7e6fdd8d9f1595b2-sd.m3u8" type="application/x-mpegURL"></video></p><h3>14.去除重复值</h3><p>在使用数据的时候，我们经常会发现给的数据里面有一些重复数据，那么在进行数据统计的时候，我们要做一些去重的处理。有的时候这些去重的处理还不是简单地把重复数据都去掉，而是把一些姓名、身份证号相同，但是可能其它某些列属性不同的数据，按照一定规则分别去重。</p><p>这个时候我们就会有简单和复杂的两种去重方法，下面这个视频就是给你介绍这两种去重方法的，对，在Excel里的去重要比数据库里的Distinct还强大。</p><p><video poster="https://media001.geekbang.org/160ec6cd89c04b86b2de204c49741ccc/snapshots/48f17fc157004935bc71d62bdcf8d7e5-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/46846d28-17c7256bc26-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/164b86d3fa724022b031dc81a90cced2/b16ebeeaf8ff4cee9280570bf5616de2-1f4cea3dd1433791becea8a38ca8eb5f-sd.m3u8" type="application/x-mpegURL"></video></p><h3>15.字符串处理函数</h3><p>前面给你讲过一个自动填充的技巧，它可以帮助我们找到一些字符之间的关系，然后自动帮你做填充，但是在某些复杂的情况下的时候，Excel无法找到比较好的规律能够自动填充。这个时候你就需要掌握一些基本的字符串的处理函数来帮你去做一些复杂的字符处理。</p><p>例如我们想把手机号码当中的4位变成星号其他位不变，以确保我们的隐私保护，这个时候你就可以使用字符串的函数来方便地解决这个问题。具体方法可以看一下我这个演示，我把最常见的几种字符串使用的函数用比较简单的方法给你讲解了一下。</p><p><video poster="https://media001.geekbang.org/2bfbaf83bd44454ab7a39add4a5037f7/snapshots/4382e21e004d4ced9c552ef90aae2547-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/19cf1845-17c7256b50c-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/eb8e186ea7084f329c3a0a2af9e4d6d1/c48ac82904d74d99af3026848c075009-65b26d2e1080a57f7d03a83d5748bd3d-sd.m3u8" type="application/x-mpegURL"></video></p><h3>16.数据匹配函数-VLOOKUP</h3><p>VLOOKUP这个函数是在Excel里面区别普通使用者和高级使用者的一个重要函数，它可以帮助我们在大量数据当中取得我们想要找的相关数据。</p><p>有时候我们也把这个函数用来做数据的比对，例如有两列，我们看看到底这两列中间哪些数据是两边都有的，哪些数据是没有的，我们会使用这个函数来做一下检查。在数据库编程里，我们叫做“关联”。Excel里用这个函数要简单得多，你看了我这个演示，一定可以把它记牢、使用好。</p><p><video poster="https://media001.geekbang.org/c62ae24fc15b4fd5bbea39d0b2fd92f0/snapshots/097312625bcd48bc98763962c470eeb4-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/14e0b1b-17c7256ad1d-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/deb06865f5c14a1da48803fe58468b92/33472032f70640a18ea8674ab3de056f-492e6a9969c9d0ac845f798e9a54aafd-sd.m3u8" type="application/x-mpegURL"></video></p><h3>17.分类汇总和统计</h3><p>我们经常会遇到要在某些分组里做统计，例如从省的维度来统计各城市的销售汇总以及销售的个数，或者是从全国的角度看各省汇总的情况。如果你会SQL，那你就知道我们可以使用数据库里一个叫做GroupBy的方法来取得这些明细数据的分组汇总值。</p><p>其实你不用把数据放到数据库里，在Excel里也可以快速获得这些汇总值，而且公式使用起来也相对简单，具体我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/626401eedb394467a4cf842106ef5e08/snapshots/82cb09a101fc49c08b7be42d327bce0e-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5d9f6e04-17c725c5a16-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/bff1a803396e4f228eea88c3af682baa/0a67d61bf86b4559b5a9ca424b5b0544-255fe31951d49edf7c2aa10d0e489704-sd.m3u8" type="application/x-mpegURL"></video></p><h3>18.数据透视表（图）</h3><p>在Excel里我们经常会面对一个非常明细的数据，想看到它分门别类的汇总或者是基于时间线的一些趋势，从而来做一些数据探索。</p><p>这时候我们就需要既可以分层汇总，还可以去过滤某些条件来针对某些情况下的一些数据进行深入探索，同时我们还希望能够用到Excel的柱状图、折线图、饼图等一些方便的图形辅助我们进行深度的数据探索。</p><p>这种情况下，数据透视表和数据透视图就应运而生了，它可以帮助我们在明细数据里面快速建立一套简单的数据分析视图，能够让你通过简单的拖拉拽快速进行数据探索和图表的生成，从而帮助发现这些数据当中隐含的规律。具体使用方法，你可以参考我这个视频当中的讲解。</p><p><video poster="https://media001.geekbang.org/d59ab9a5312d4a8c88634d122c368499/snapshots/920afac6cbcf43c8a39bd2e3f38e400c-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/4918d823-17c725b04ae-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/fd1b92e39a484b48bf9ad8954be12b88/a82b78477744402bb9e397afcfeef77c-72cf4e808c000306cbdb12d0b5b91ad3-sd.m3u8" type="application/x-mpegURL"></video></p><h2>小结</h2><p>到这里，我就把我自己最常用的18种Excel使用技巧教给你了。不知道你发现没有，我们没有像很多Excel课程一样，事无巨细地把所有技巧全都罗列出来，因为我觉得在日常数据分析当中，并不需要记住所有的Excel功能，并且这也是不现实的。</p><p>我介绍的这18种技巧是我和团队在做数据分析的时候，最常用的18种技巧，真的希望你可以通过视频的讲解深深记住。18种其实并不多，我相信你只要花点时间，用心记一记，一定可以掌握。如果你掌握了这18种技巧，在你工作和生活中真正使用的时候，你会发现它可以在你的数据分析、日常管理、自己个人财务分析等诸多方面有非常大的帮助。</p><p>数据给你一双看透本质的眼睛，熟练掌握一种得心用手的数据分析工具，比你只是“会”10种数据分析工具要强大得多。</p><h2>课后思考</h2><p>还有哪些Excel函数你常用的？使用场景是什么呢？分享出来，我们一起提高！</p><h2>参考资料</h2><p>你可以点击<a href="https://pan.baidu.com/s/1DqC7GNgq9DYXOfo-U0BvwA">这里</a>（提取码hnwf）获取我们这节课的Excel文件，方便你进一步学习。</p>
<p>数据给你一双看透本质的眼睛，这里是《数据分析思维课》，我是郭炜。</p><p>上一节课给你讲了最新的数据科技技术，你会不会感觉已经跃跃欲试了？其实在我们日常的工作和生活当中，往往你需要基于小数据快速做出一些决策和分析，所以我们使用最频繁的不是这些高深的大数据平台或者算法平台，而是Excel这个数据分析的神器。</p><p>我原来以为很多人对这个东西应该非常熟悉，但后来我和我的数据分析团队算法工程师以及管理团队交流时，才发现大家对这个工具的使用方法还停留在最简单的输入和简单计算阶段，很难发挥出它在实际数据分析中的真正实力，这在某种程度上也会造成我们管理、开发效率低下。</p><p>所以在接下来的这几节课里，我准备专门针对Excel的功能给你做一下普及，把我最常用的一些技巧和我认为无论你是做管理或者做数据分析都有必要学的一些知识点梳理出来。相信你学习完以后就会事半功倍，让Excel成为你数据分析的神器。</p><p>为了让你能快速掌握，这几节课我都准备用视频辅助讲解的方式来进行。我会在文字稿中把使用的场景和大概的技巧简单给你介绍一下，具体如何使用，请你看下我给你录制好的手把手视频，保证你一看就会，一试就通。那话不多说，我们直接开始吧！</p><h3>1.我常用的快捷键</h3><!-- [[[read_end]]] --><p>首先给你介绍一下我常用的Excel里的快捷方式。我知道这方面的文章特别多，往往能够介绍好几十种快捷方式，但其实真正常用的就是我在下面要给你介绍的这4种，记住这几个快捷键，他们可以帮助你快速提高你的工作效率。</p><ul>
<li>下拉自动填充：多种双击自动填充的方法；</li>
<li>单元格里如何换行：Alt+Enter；</li>
<li>自动重复上一个动作的快捷键：F4；</li>
<li>去除科学计数法的符号：单引号。</li>
</ul><p>我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/6afdeed0520b4ca498e0d54b9223d544/snapshots/6630d0f9aaa7406fb5ae85fcf95a076c-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/48c530a3-17c68f2f4e0-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/8bfa917199954b65bde619311ce97c3f/68891c438efd4ae5b9f8b489653a5d5d-dee3aaf48247fdc566c5b4312a42cf85-sd.m3u8" type="application/x-mpegURL"></video></p><h3>2.多选重复录入</h3><p>很多时候我们在做Excel的时候，只知道选择某一个单元格来做处理，其实Excel有非常强大的选择能力，能够选择某些同样类型的单元格，然后统一输入某些公式或者数字，比如我们会把一些空的单元格输入某个数字或者公式。</p><p>这件事情怎么来做呢？我们可以用F5和Ctrl+Enter来解决这方面的问题，详情我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/764b80bf133646b4b0da4b98703b069d/snapshots/4d636d77d0874b919e5ea0c32ce5aefc-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/46e35974-17c68f2f1bb-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/da9b9e94faac46d893e14358de9061ee/b0d61e09f513483b98dcf70fdb42f236-9c673a450fafaff485fe6c72c5641e3a-sd.m3u8" type="application/x-mpegURL"></video></p><h3>3.神奇的智能填充</h3><p>我们经常会需要去拆分一些有规律的格式，比如说我们想从身份证号来拆成出生日期，或者把一堆内容加上书名号或者引号，这个时候怎么办呢？</p><p>程序员肯定告诉你要么就得一个一个往里敲，要么就得通过复杂的字符串公式才行。但其实Excel有一个非常方便的方法叫智能填充（使用 Ctrl+E），它可以非常方便地寻找到前面的字符规律，自动给你填充进去。</p><p>你可以看一下我视频当中的这个例子，你会惊奇地发现原来Excel这么智能，当然如果这种规律Excel无法发现的时候，你就要用我们下节课会讲到的第15种技巧字符串函数来处理了。</p><p><video poster="https://media001.geekbang.org/23ffaf6a4406406788157c0903cc4e3f/snapshots/759def8d61764c68ad12d7f88674e08c-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/60e05b03-17c68f2ed05-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/313fc733d1064dcabce67dee2639db67/136d1e49c4da4e9cad313d018f711427-49293b1dadf056e47056d1c4b5674bd0-sd.m3u8" type="application/x-mpegURL"></video></p><h3>4.相对位置、绝对位置</h3><p>你在使用Excel公式的时候，经常会在里面写一个公式，然后在单元格里面加一个等号，去选择某几个单元格相加或者使用某种公式计算。这时候你使用的是相对位置，也就是它会随着你的单元格变化，里面的单元格引用公式也会发生变化。</p><p>在这种情况下，计算某些汇率、单价到总价的时候就很麻烦，怎么办呢？你可以使用绝对位置来解决这些特殊的情况的问题，你可以参考一下这段视频。</p><p><video poster="https://media001.geekbang.org/6f3e97d0f5a14e4f8658005de8be7496/snapshots/43edc2c1765742d693e468f396bb5fb0-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/20125137-17c68f2e6f3-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/a78be336a52146ce807e6fe78d2698f8/974b28d3a8164107a80ce62bf545014f-3afc0d8034cb8ece7e75726f5271d18a-sd.m3u8" type="application/x-mpegURL"></video></p><h3>5.单元格合并、解除合并自动填充</h3><p>我们经常会拿到一些中国式报表的数据，里边有各种各样合并单元格的数据，但是我们在使用公式和其他进行计算的时候，这些合并的单元格反而影响了我们的整个计算过程（因为它们除了第一个单元格有数值，其它都是空的）。怎么样能把这些合并的单元格全都把它填上数据呢？这里面就有一个非常有意思的技巧，你可以看看下面的这个视频。</p><p><video poster="https://media001.geekbang.org/32b4ba0ea43c4ca4af0fa86cb92bc49c/snapshots/6538d29cdc714480b44c15b4f7c4f903-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5d65cb65-17c68f2e298-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/ae81651cb3bf4ea6885776982d114591/ffad74828c5d4d92a48e0b45cb929e6e-06ddd98ed7b6492ea248d0cd68fcfa7f-sd.m3u8" type="application/x-mpegURL"></video></p><h3>6.自动分列</h3><p>我们经常会拿到一些数据，这些数据不是所谓的csv格式（也就是逗号分隔的），而是有一些奇怪的分隔符号，有的是Tab符号，有的是竖线。我们现在希望是最后拆完以后变成每一列可以做数据处理的样子，这里就会用到Excel分列的功能，具体我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/cfd4e165cb81464f817347e1dc120afd/snapshots/ca360367f1774e9a83d81391bf03fd48-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/12a71093-17c68f67bd5-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/f8d781a6b11646cd81e85c748646fed9/520b34be2d4b4a5e826b03b65f799396-f628038c758be0ac7f2e9eae0d20e931-sd.m3u8" type="application/x-mpegURL"></video></p><h3>7.求和技巧</h3><p>接下来给你讲讲求和技巧。你可能会说求和谁不会，你现在已经不用一个个单元格去加了，直接会用SUM这个函数求和。但其实我要和你说，这个技巧也过时了。</p><p>其实，你直接选择要加和的单元用Alt+=，就能把这个问题解决了，而且加上我们上面讲的第2个技巧，你可以快速解决多个小计的求和问题，绝对是求和公式里的战斗机。下面我来给你演示一下高手的求和是怎么做的。</p><p><video poster="https://media001.geekbang.org/103925fbf8f646f0b6313af4ca468aa3/snapshots/be8edfe0fd084e23a77fd25fe013ae0d-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5b8ad7dc-17c68f6783e-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/ea968e9d5a334f5985bbcc96c7460e7d/114b5f96152746279ee20d828709850a-f62296aafdc24a7302f5fbfe7715490b-sd.m3u8" type="application/x-mpegURL"></video></p><h3>8.数据过滤和排序</h3><p>很多小伙伴会用数据过滤，也就是筛选一下某几个特定值相对应的行进行统计和分析。但其实Excel的数据过滤里面有非常复杂的条件逻辑，例如大于某一个数值、包含某一个单词，或者你可以有好几个条件把它相互进行合并。</p><p>而排序也不单单局限于简单的针对某一列的排序，你可以有主排序的列以及第二排序序列和第三排序序列。在一些数据有重复值的时候，你可以非常方便去找到合适的排名，具体方法我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/affd16f6d1424d61af85dffa85bc7343/snapshots/79b50157d0ca4ad08eddac49c4aafec9-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/20d1b562-17c68f6729f-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/287bfa5be940416b9032ad22816727c5/6cc2f91f7a0f43329c3ad8347fc31c4a-6ee0c07bb744ac1c479666549f070748-sd.m3u8" type="application/x-mpegURL"></video></p><h3>9.最大值、最小值、次大值、次小值</h3><p>想要找到一个列里面的最大值和最小值是有专门的函数能直接得出的，这并不稀奇。但其实你可能并不知道，Excel能非常方便地取得这个列里面的第n个次大值或者第n个次小值，也就是它不仅仅可以帮你找到冠军，还可以帮你找到亚军、季军。怎么样才能够去实现呢？我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/6cdd5a11a6d94bcc8ca6985c0d090368/snapshots/db4aaa6dc2f44de1bd62b63ad4e593cb-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5d0eac80-17c68f66f86-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/b98d267a94b94e0cb611fd0ced10c5e0/ca5949f94e60438c9c132358ff254754-ff1582a97f927f0544c58b1a0bf6e9ff-sd.m3u8" type="application/x-mpegURL"></video></p><h3>10.选择性粘贴</h3><p>说到复制粘贴我们都不陌生，这太简单了，就是Ctrl+C加Ctrl+V。但其实在Excel里面，复制粘贴有非常复杂的一些用法。你可以只复制公式过去，也可以只复制数值过去，甚至你可以通过选择性粘贴，把一个横表转成纵表，我来给你演示一下。</p><p><video poster="https://media001.geekbang.org/1ac71786bb854f3fbf80912e8ebeb315/snapshots/9bc0a492acfb498ba874986fef59cf6c-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/4efe1650-17c68f66ada-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/d8d3973e4ceb4e4d8639c1fbccb86e36/15e55f7c2c194756ab64cfe8a9537724-35f4719b5fd74069a8ff8f015545f763-sd.m3u8" type="application/x-mpegURL"></video></p><h3>11.保留某几位小数</h3><p>说到某个数值（例如金额）保留到几位小数，你可能第一个感觉会是使用Excel里面的单元格格式去设定一下小数位，但是这种方法会在使用计算公式的时候会出现一些偏差。比如你显示的是两位小数，但其实背后它是一个10位的小数，那么你在进行其他计算的时候，它会按10位小数计算，就出现一些细微数据不准确的情况。</p><p>所以为了避免这种情况发生，我们往往会通过公式把它变成最后只保留两位的形式。这种保留小数有两种方式，一种是直接去掉所有的小数向下取整，还一种是你常见的四舍五入，具体方法我在下面的视频会给你演示一下，希望你记住。</p><p><video poster="https://media001.geekbang.org/9edbfbb5724a48878e8ac55d0642f6d1/snapshots/7cfbf2e40a9442dab2674b24518560f1-00005.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/aff3947-17c68fa0e36-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/300c85d3d22c482c8e277218910da533/7b162c809bab420d907aaa7ddbefdcbb-626484526b740aa0dec4e04c6b593790-sd.m3u8" type="application/x-mpegURL"></video></p><h2>小结</h2><p>这节课到这里，我相信即使你是文科生，学了这几个技巧，你也会发现原来复杂的数据处理也并不是理工科学生的专有特长，你也可以做一些快速的数据处理。而如果你是理科生，你会发现原来并不是所有事情都要编程序来实现的，Excel几个按键就可以代替你编一大段程序，所见即所得。</p><p>另外再小小预告一下，下节课我会给你介绍一些Excel更复杂的例子，基本上用了Excel，在它数据处理量级范围内，你可以忘记数据库编程了。套用一个网络用语，对，小数据分析神器Excel，它就是什么神奇！</p><p>数据给你一双看透本质的眼睛，想要快速处理数据的其实只有一句话：“无他，但手熟尔”。</p><h2>课后思考</h2><p>你还有哪些觉得比较好用的Excel快捷键和简单小技巧？分享出来，大家都觉得不错的，我会加到将来的加餐里。</p><h2>参考资料</h2><p>你可以点击<a href="https://pan.baidu.com/s/1DqC7GNgq9DYXOfo-U0BvwA">这里</a>（提取码hnwf）获取我们这节课的Excel文件，方便你进一步学习。</p>